---
title: Cluster Analysis(CA) and PCA(Principal Component Analysis)
output: pdf_document
---

```{r}
library(caret)
library(neuralnet)
library(randomForest)
library(rpart)
library(rattle)
library(MASS)
library(tidyverse)
library(glmnet)
library(leaps)
library(ggplot2)
```

1.
```{r}
str(iris)
data <- na.omit(iris)
data <- scale(data[,-5])
pc <- princomp(data,cor=TRUE)
# princomp performs a principal components analysis on the given numeric data matrix and returns the results as an object of class princomp.

# Scree-plot
library(factoextra)
fviz_eig(pc)

fviz_nbclust(data,kmeans,method="gap_stat")
```

# K means
```{r}
k.means.fit <- kmeans(data,3)
library(cluster)
clusplot(data,k.means.fit$cluster,main="2D representation of the Cluster solution",color=TRUE,shade=TRUE,labels=2,lines=0)
table(k.means.fit$cluster,iris$Species)
# accuracy = (50+39+36)/150 = 125/150
```

# H.ward
```{r}
d <- dist(data, method="euclidean")
H.fit <- hclust(d,method="ward.D")
plot(H.fit)
rect.hclust(H.fit,k=3,border="red")
fviz_dend(H.fit,k=3,cex=0.5,k_colors=c("#2E9FDF","#00AFBB","#E7B800"),color_labels_by_k = TRUE,rect = TRUE)
groups <- cutree(H.fit,k=3)
clusters <- factor(groups, levels=1:3,labels=c("setosa","versicolor","virginica"))
clusplot(data,groups,main="2D representation of the Cluster solution", color=TRUE, shade=TRUE, labels=2, lines=0)
table(iris[,5],clusters)
# accuracy = (49+50+27)/150
```

# H.single
```{r}
H.fit <- hclust(d,method="single")
plot(H.fit)
rect.hclust(H.fit,k=3,border="red")
fviz_dend(H.fit,k=3,cex=0.5,k_colors=c("#2E9FDF","#00AFBB","#E7B800"),color_labels_by_k = TRUE,rect = TRUE)
groups <- cutree(H.fit,k=3)
clusplot(data,groups,main="2D representation of the Cluster solution",color=TRUE, shade=TRUE, labels = 2,lines = 0)
clusters <- factor(groups,levels=1:3,labels=c("setosa","versicolor","virginica"))
table(iris[,5],clusters)
# accuracy = (49+50)/150
```

# H.complete
```{r}
H.fit <- hclust(d, method="complete")
plot(H.fit)
rect.hclust(H.fit,k=3,border="red")
fviz_dend(H.fit,k=3,cex=0.5,k_colors=c("#2E9FDF","#00AFBB","#E7B800"),color_labels_by_k = TRUE,rect = TRUE)
groups <- cutree(H.fit,k=3)
clusplot(data,groups,main="2D representation of the Cluster solution",color=TRUE,shade=TRUE,labels=2,lines=0)
clusters <- factor(groups,levels=1:3,labels=c("setosa","versicolor","virginica"))
table(iris[,5],clusters)
# accuracy = (49+21+48)/150
```


# H.Average
```{r}
H.fit <- hclust(d,method="average")
plot(H.fit)
rect.hclust(H.fit,k=3,border="red")
fviz_dend(H.fit,k=3,cex=0.5,k_colors=c("#2E9FDF","#00AFBB","#E7B800"),color_labels_by_k = TRUE,rect = TRUE)
groups <- cutree(H.fit,k=3)
clusplot(data,groups,main="2D representation of the Cluster solution",color=TRUE,shade=TRUE,labels = 2,lines = 0)
clusters <- factor(groups,levels=1:3,labels=c("setosa","versicolor","virginica"))
table(iris[,5],clusters)
# accuracy = (50+50+3)/150
```

# H.centroid
```{r}
H.fit <- hclust(d,method="centroid")
plot(H.fit)
rect.hclust(H.fit,k=3,border="red")
fviz_dend(H.fit,k=3,cex=0.5,k_colors=c("#2E9FDF","#00AFBB","#E7B800"),color_labels_by_k = TRUE,rect = TRUE)
groups <- cutree(H.fit,k=3)
clusplot(data,groups,main="2D representation of the Cluster solution",color=TRUE,shade = TRUE, labels = 2, lines = 0)
clusters <- factor(groups,levels=1:3,labels=c("setosa","versicolor","virginica"))
table(iris[,5],clusters)
# accuracy = (49+50)/150
```
Comparision
Ward > K-means > Complete > Average > Single = Centroid
**I would recommend the cluster analysis as a good way to deal with the IRIS dataset.**
**K-means and complete methods are usually great, but here Ward method is the best one from the confusion matrix.**

2.
```{r}
library(devtools)
library(ggbiplot)
```

(a)
```{r}
iris.pca <- prcomp(data,center=TRUE,scale. = TRUE)
summary(iris.pca)
```

(b)
```{r}
ggbiplot(iris.pca)
```

(c)
```{r}
ggbiplot(iris.pca, ellipse = TRUE, groups = iris$Species)
```

(d)
```{r}
iris.pca$rotation[,1] #PC1
```

I recommend the PCA method as an efficient way here. It can reduce the dimension of the data, and the first two PC have a cumulative proportion of variance over 95%, which means this two PCs contains most of the information of the original variables. Additionally, the bi-plot created in part (c) would allows the biologists to see the groupings of species clearly. 